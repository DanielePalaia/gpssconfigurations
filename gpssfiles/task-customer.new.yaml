DATABASE: aia_datastore
USER: gpadmin
HOST: 172.21.0.5
PORT: 6432
KAFKA:
   INPUT:
     SOURCE:
        BROKERS: localhost:9092
        TOPIC: customertoday
     COLUMNS:
        - NAME: jdata
          TYPE: json
     FORMAT: json
     ERROR_LIMIT: 10
   OUTPUT:
     TABLE: customer
     MODE: MERGE
     MATCH_COLUMNS:
        - customerkey

     UPDATE_COLUMNS:
        - countrykey
        - changecyclerequestdate
        - salesrating
        - customerkey
        - customerlegalname
        - fiscalyearenddate
        - crmcustomermaincontactsourceid
        - lastactivityreasonkey
        - changecyclerequestflag
        - externalid
        - rootorganizationkey
        - billingcyclekey
        - requestedbillcyclefrequencyind
        - employeesnumber
        - requestedbillingcyclekey
        - defaultprepaidpaychannelkey
        - rootorganizationname
        - postalstreetname
        - crmcustomersourceid
        - saleschannelkey
        - streetaddress
        - phonenumber
        - bssmodificationdate
        - bsscreationdate
        - creditclasskey
        - email
        - businesspurposedesc
        - crmbusinessorganizationsourceid
        - acquisitiondate
        - parentorganizationkey
        - maincontactkey
        - zipcode
        - defaultpostpaidpaychannelkey
        - largecustomerflag
        - structuretypeind
        - customerstatuskey
        - revenuerange
        - opendate
        - website
        - citykey
        - dealerkey
        - customersubtypekey
        - customertypekey
        - billcyclefrequencyind
        - mainaddresskey
        - cmcustomersourceid
        - stockcode
        - changecyclerequeststatusind
        - statekey
     MAPPING:
        - NAME: countrykey
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'countryKey')::text
        - NAME: changecyclerequestdate
          EXPRESSION: to_timestamp((json_array_elements(jdata->'repeatedMessages'->'Customer')->>'changeCycleRequestDate')::double precision/1000)
        - NAME: salesrating
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'salesRating')::text
        - NAME: customerkey
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'customerKey')::text
        - NAME: customerlegalname
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'customerLegalName')::text
        - NAME: fiscalyearenddate
          EXPRESSION: to_timestamp((json_array_elements(jdata->'repeatedMessages'->'Customer')->>'fiscalYearEndDate')::double precision/1000)
        - NAME: crmcustomermaincontactsourceid
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'crmCustomerMainContactSourceId')::text
        - NAME: lastactivityreasonkey
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'lastActivityReasonKey')::text
        - NAME: changecyclerequestflag
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'changeCycleRequestFlag')::text
        - NAME: externalid
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'externalId')::text
        - NAME: rootorganizationkey
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'rootOrganizationKey')::text
        - NAME: billingcyclekey
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'billingCycleKey')::text
        - NAME: requestedbillcyclefrequencyind
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'requestedBillCycleFrequencyInd')::text
        - NAME: employeesnumber
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'employeesNumber')::text
        - NAME: requestedbillingcyclekey
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'requestedBillingCycleKey')::text
        - NAME: defaultprepaidpaychannelkey
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'defaultPrepaidPayChannelKey')::text
        - NAME: rootorganizationname
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'rootOrganizationName')::text
        - NAME: postalstreetname
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'postalStreetName')::text
        - NAME: crmcustomersourceid
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'crmCustomerSourceId')::text
        - NAME: saleschannelkey
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'salesChannelKey')::text
        - NAME: streetaddress
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'streetAddress')::text
        - NAME: phonenumber
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'phoneNumber')::text
        - NAME: bssmodificationdate
          EXPRESSION: to_timestamp((json_array_elements(jdata->'repeatedMessages'->'Customer')->>'bssModificationDate')::double precision/1000)
        - NAME: bsscreationdate
          EXPRESSION: to_timestamp((json_array_elements(jdata->'repeatedMessages'->'Customer')->>'bssCreationDate')::double precision/1000)
        - NAME: creditclasskey
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'creditClassKey')::text
        - NAME: email
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'email')::text
        - NAME: businesspurposedesc
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'businessPurposeDesc')::text
        - NAME: crmbusinessorganizationsourceid
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'crmBusinessOrganizationSourceId')::text
        - NAME: acquisitiondate
          EXPRESSION: to_timestamp((json_array_elements(jdata->'repeatedMessages'->'Customer')->>'acquisitionDate')::double precision/1000)
        - NAME: parentorganizationkey
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'parentOrganizationKey')::text
        - NAME: maincontactkey
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'mainContactKey')::text
        - NAME: zipcode
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'zipCode')::text
        - NAME: defaultpostpaidpaychannelkey
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'defaultPostpaidPayChannelKey')::text
        - NAME: largecustomerflag
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'largeCustomerFlag')::text
        - NAME: structuretypeind
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'structureTypeInd')::text
        - NAME: customerstatuskey
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'customerStatusKey')::text
        - NAME: revenuerange
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'revenueRange')::text
        - NAME: opendate
          EXPRESSION: to_timestamp((json_array_elements(jdata->'repeatedMessages'->'Customer')->>'openDate')::double precision/1000)
        - NAME: website
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'webSite')::text
        - NAME: citykey
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'cityKey')::text
        - NAME: dealerkey
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'dealerKey')::text
        - NAME: customersubtypekey
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'customerSubTypeKey')::text
        - NAME: customertypekey
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'customerTypeKey')::text
        - NAME: billcyclefrequencyind
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'billCycleFrequencyInd')::text
        - NAME: mainaddresskey
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'mainAddressKey')::text
        - NAME: cmcustomersourceid
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'cmCustomerSourceId')::text
        - NAME: stockcode
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'stockCode')::text
        - NAME: changecyclerequeststatusind
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'changeCycleRequestStatusInd')::text
        - NAME: statekey
          EXPRESSION: (json_array_elements(jdata->'repeatedMessages'->'Customer')->>'stateKey')::text
        - NAME: row_update_time__
          EXPRESSION: "NOW()"
   COMMIT:
     MAX_ROW: 1000
     MINIMAL_INTERVAL: 1000

