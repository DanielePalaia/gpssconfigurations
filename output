DATABASE: aia_datastore
USER: gpadmin
HOST: 172.21.0.5
PORT: 6432
KAFKA:
   INPUT:
     SOURCE:
        BROKERS: localhost:9092
        TOPIC: test_aLDMCustomer
     COLUMNS:
        - NAME: jdata
          TYPE: json
     FORMAT: json
     ERROR_LIMIT: 10
   OUTPUT:
     TABLE: customer
     MAPPING:

        - NAME: countryKey
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'countryKey'::varchar as countryKey
        - NAME: changeCycleRequestDate
          EXPRESSION: to_timestamp((json_array_elements(jdata->'repeatedMessages'->'Customer')->>'changeCycleRequestDate')::double precision/1000) as changeCycleRequestDate
        - NAME: salesRating
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'salesRating'::varchar as salesRating
        - NAME: customerKey
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'customerKey'::varchar as customerKey
        - NAME: customerLegalName
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'customerLegalName'::varchar as customerLegalName
        - NAME: fiscalYearEndDate
          EXPRESSION: to_timestamp((json_array_elements(jdata->'repeatedMessages'->'Customer')->>'fiscalYearEndDate')::double precision/1000) as fiscalYearEndDate
        - NAME: crmCustomerMainContactSourceId
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'crmCustomerMainContactSourceId'::varchar as crmCustomerMainContactSourceId
        - NAME: lastActivityReasonKey
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'lastActivityReasonKey'::varchar as lastActivityReasonKey
        - NAME: changeCycleRequestFlag
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'changeCycleRequestFlag'::varchar as changeCycleRequestFlag
        - NAME: externalId
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'externalId'::varchar as externalId
        - NAME: transactionTime
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'transactionTime'::varchar as transactionTime
        - NAME: rootOrganizationKey
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'rootOrganizationKey'::varchar as rootOrganizationKey
        - NAME: billingCycleKey
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'billingCycleKey'::varchar as billingCycleKey
        - NAME: operation
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'operation'::varchar as operation
        - NAME: requestedBillCycleFrequencyInd
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'requestedBillCycleFrequencyInd'::varchar as requestedBillCycleFrequencyInd
        - NAME: employeesNumber
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'employeesNumber'::varchar as employeesNumber
        - NAME: requestedBillingCycleKey
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'requestedBillingCycleKey'::varchar as requestedBillingCycleKey
        - NAME: defaultPrepaidPayChannelKey
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'defaultPrepaidPayChannelKey'::varchar as defaultPrepaidPayChannelKey
        - NAME: rootOrganizationName
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'rootOrganizationName'::varchar as rootOrganizationName
        - NAME: postalStreetName
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'postalStreetName'::varchar as postalStreetName
        - NAME: queryTime
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'queryTime'::varchar as queryTime
        - NAME: crmCustomerSourceId
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'crmCustomerSourceId'::varchar as crmCustomerSourceId
        - NAME: salesChannelKey
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'salesChannelKey'::varchar as salesChannelKey
        - NAME: streetAddress
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'streetAddress'::varchar as streetAddress
        - NAME: phoneNumber
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'phoneNumber'::varchar as phoneNumber
        - NAME: bssModificationDate
          EXPRESSION: to_timestamp((json_array_elements(jdata->'repeatedMessages'->'Customer')->>'bssModificationDate')::double precision/1000) as bssModificationDate
        - NAME: bssCreationDate
          EXPRESSION: to_timestamp((json_array_elements(jdata->'repeatedMessages'->'Customer')->>'bssCreationDate')::double precision/1000) as bssCreationDate
        - NAME: creditClassKey
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'creditClassKey'::varchar as creditClassKey
        - NAME: email
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'email'::varchar as email
        - NAME: businessPurposeDesc
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'businessPurposeDesc'::varchar as businessPurposeDesc
        - NAME: crmBusinessOrganizationSourceId
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'crmBusinessOrganizationSourceId'::varchar as crmBusinessOrganizationSourceId
        - NAME: acquisitionDate
          EXPRESSION: to_timestamp((json_array_elements(jdata->'repeatedMessages'->'Customer')->>'acquisitionDate')::double precision/1000) as acquisitionDate
        - NAME: parentOrganizationKey
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'parentOrganizationKey'::varchar as parentOrganizationKey
        - NAME: mainContactKey
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'mainContactKey'::varchar as mainContactKey
        - NAME: zipCode
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'zipCode'::varchar as zipCode
        - NAME: defaultPostpaidPayChannelKey
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'defaultPostpaidPayChannelKey'::varchar as defaultPostpaidPayChannelKey
        - NAME: largeCustomerFlag
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'largeCustomerFlag'::varchar as largeCustomerFlag
        - NAME: structureTypeInd
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'structureTypeInd'::varchar as structureTypeInd
        - NAME: customerStatusKey
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'customerStatusKey'::varchar as customerStatusKey
        - NAME: revenueRange
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'revenueRange'::varchar as revenueRange
        - NAME: openDate
          EXPRESSION: to_timestamp((json_array_elements(jdata->'repeatedMessages'->'Customer')->>'openDate')::double precision/1000) as openDate
        - NAME: webSite
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'webSite'::varchar as webSite
        - NAME: cityKey
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'cityKey'::varchar as cityKey
        - NAME: dealerKey
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'dealerKey'::varchar as dealerKey
        - NAME: customerSubTypeKey
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'customerSubTypeKey'::varchar as customerSubTypeKey
        - NAME: customerTypeKey
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'customerTypeKey'::varchar as customerTypeKey
        - NAME: billCycleFrequencyInd
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'billCycleFrequencyInd'::varchar as billCycleFrequencyInd
        - NAME: mainAddressKey
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'mainAddressKey'::varchar as mainAddressKey
        - NAME: cmCustomerSourceId
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'cmCustomerSourceId'::varchar as cmCustomerSourceId
        - NAME: stockCode
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'stockCode'::varchar as stockCode
        - NAME: changeCycleRequestStatusInd
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'changeCycleRequestStatusInd'::varchar as changeCycleRequestStatusInd
        - NAME: targetUpdateTime
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'targetUpdateTime'::varchar as targetUpdateTime
        - NAME: stateKey
          EXPRESSION: json_array_elements(jdata->'repeatedMessages'->'Customer')->>'stateKey'::varchar as stateKey

  COMMIT:
    MAX_ROW:1
    MINIMAL_INTERVAL:1000
